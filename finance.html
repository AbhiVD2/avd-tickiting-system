<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <h1 class="text-2xl font-bold mb-4">Finance Dashboard</h1>
        <div class="mb-4">
            <label for="society-filter" class="block text-sm font-medium text-gray-700">Filter by Society</label>
            <select id="society-filter" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
                <option value="all">All Societies</option>
                <option value="society1">Society 1</option>
                <option value="society2">Society 2</option>
                <option value="society3">Society 3</option>
                <!-- Add more societies as needed -->
            </select>
        </div>
        <div class="mb-4">
            <label for="category-filter" class="block text-sm font-medium text-gray-700">Filter by Category</label>
            <select id="category-filter" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
                <option value="all">All</option>
                <option value="maintenance">Maintenance</option>
                <option value="fines">Fines</option>
                <option value="parking">Parking Charges</option>
                <option value="security">Security Charges</option>
                <option value="other">Other Expenses</option>
            </select>
        </div>
        <div class="flex">
            <div class="w-1/5">
                <canvas id="finance-chart" class="mb-4"></canvas>
            </div>
            <div class="w-4/5">
                <table class="min-w-full bg-white">
                    <thead>
                        <tr>
                            <th class="py-2 px-4 border-b">Category</th>
                            <th class="py-2 px-4 border-b">Amount</th>
                            <th class="py-2 px-4 border-b">Date</th>
                            <th class="py-2 px-4 border-b">Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="py-2 px-4 border-b">Maintenance</td>
                            <td class="py-2 px-4 border-b">$500</td>
                            <td class="py-2 px-4 border-b">2023-10-01</td>
                            <td class="py-2 px-4 border-b">Monthly maintenance fee</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border-b">Fines</td>
                            <td class="py-2 px-4 border-b">$50</td>
                            <td class="py-2 px-4 border-b">2023-10-05</td>
                            <td class="py-2 px-4 border-b">Late payment fine</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border-b">Parking Charges</td>
                            <td class="py-2 px-4 border-b">$100</td>
                            <td class="py-2 px-4 border-b">2023-10-10</td>
                            <td class="py-2 px-4 border-b">Monthly parking fee</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border-b">Security Charges</td>
                            <td class="py-2 px-4 border-b">$200</td>
                            <td class="py-2 px-4 border-b">2023-10-15</td>
                            <td class="py-2 px-4 border-b">Monthly security fee</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border-b">Other Expenses</td>
                            <td class="py-2 px-4 border-b">$150</td>
                            <td class="py-2 px-4 border-b">2023-10-20</td>
                            <td class="py-2 px-4 border-b">Miscellaneous expenses</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const ctx = document.getElementById('finance-chart').getContext('2d');
            const financeChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Maintenance', 'Fines', 'Parking Charges', 'Security Charges', 'Other Expenses'],
                    datasets: [{
                        label: 'Amount',
                        data: [500, 50, 100, 200, 150],
                        backgroundColor: [
                            'rgba(75, 192, 192, 0.2)',
                            'rgba(255, 99, 132, 0.2)',
                            'rgba(255, 206, 86, 0.2)',
                            'rgba(54, 162, 235, 0.2)',
                            'rgba(153, 102, 255, 0.2)'
                        ],
                        borderColor: [
                            'rgba(75, 192, 192, 1)',
                            'rgba(255, 99, 132, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(153, 102, 255, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            function updateData() {
                const society = document.getElementById('society-filter').value;
                const category = document.getElementById('category-filter').value;
                // Fetch data from API and update chart and table
                fetch(`/api/finance?society=${society}&category=${category}`)
                    .then(response => response.json())
                    .then(data => {
                        // Update chart data
                        financeChart.data.datasets[0].data = data.map(item => item.amount);
                        financeChart.update();
                        // Update table data
                        const tbody = document.querySelector('tbody');
                        tbody.innerHTML = '';
                        data.forEach(item => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td class="py-2 px-4 border-b">${item.category}</td>
                                <td class="py-2 px-4 border-b">$${item.amount}</td>
                                <td class="py-2 px-4 border-b">${item.date}</td>
                                <td class="py-2 px-4 border-b">${item.description}</td>
                            `;
                            tbody.appendChild(row);
                        });
                    });
            }

            document.getElementById('society-filter').addEventListener('change', updateData);
            document.getElementById('category-filter').addEventListener('change', updateData);
        });
    </script>
</body>
</html>
